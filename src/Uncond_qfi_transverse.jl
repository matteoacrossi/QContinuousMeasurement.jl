"""
    uncond_QFI_transverse(t, N, κ, ω)


Analytical unconditional QFI for ``N`` atoms interacting with independent transverse
noise with coupling ``\\κ``, in a magnetic field ω.

`t` is a time instant

"""
function uncond_QFI_transverse(t, N, κ, ω)
    tot=0.
    for m=0:N
        r11= ρDiag(m,N,t,κ)
        r12=ρAntiDiag(m,N,t,κ, Complex(ω))
        dr12=dρAntiDiag(m,N,t,κ, Complex(ω))
        tot+= binomial(N,m)*QFIqubit(r11,r12,dr12)
    end
    return 0.5*real(tot)
end


ρDiag(m,N,t,κ) =
    0.5 .* (2.0^(-N) .* (1+-exp.(-κ .* t)) .^ (-m+N) .* (1.0+exp.(-κ .* t)) .^ m+2.0^(-N) .* (1-exp.(-κ .* t)) .^ m .* (1+exp.(-κ .* t)) .^ (-m+N))
ρAntiDiag(m,N,t,κ,ω) = (0.5) .* ((exp.((-0.5) .* κ .* t) .* κ .* (κ .^ 2-4.0 .* ω .^ 2) .^ (-0.5) .* sinh.((0.5) .* (κ .^ 2-4.0 .* ω .^ 2) .^ (0.5) .* t)) .^ m .* (exp.((-0.5) .* κ .* t) .* (cosh.((0.5) .* (κ .^ 2-4.0 .* ω .^ 2) .^ (0.5) .* t)+(1im*(-2)) .* ω .* (κ .^ 2-4.0 .* ω .^ 2) .^ (-0.5) .* sinh.((0.5) .* (κ .^ 2-4.0 .* ω .^ 2) .^ (0.5) .* t))) .^ (-m+N)+(exp.((-0.5) .* κ .* t) .* κ .* (κ .^ 2+(-4) .* ω .^ 2) .^ (-0.5) .* sinh.((0.5) .* (κ .^ 2-4.0 .* ω .^ 2) .^ (0.5) .* t)) .^ (-m+N) .* (exp.((-0.5) .* κ .* t) .* (cosh.((0.5) .* (κ .^ 2-4.0 .* ω .^ 2) .^ (0.5) .* t)+(1im*2) .* ω .* (κ .^ 2-4.0 .* ω .^ 2) .^ (-0.5) .* sinh.((0.5) .* (κ .^ 2-4.0 .* ω .^ 2) .^ (0.5) .* t))) .^ m)
dρAntiDiag(m,N,t,κ,ω)=-(κ .^ (2.0)+(-4) .* ω .^ (2.0)) .^ (-1.5) .* (exp.((-0.5) .* κ .* m .* t) .* m .* ω .* (κ .^ (2.0)+(-4) .* ω .^ (2.0)) .^ ((0.5)+(-0.5) .* m) .* ((-2)+(κ .^ (2.0)+(-4) .* ω .^ (2.0)) .^ (0.5) .* t .* coth.((0.5) .* (κ .^ (2.0)+(-4) .* ω .^ (2.0)) .^ (0.5) .* t)) .* (κ .* sinh.((0.5) .* (κ .^ (2.0)+(-4) .* ω .^ (2.0)) .^ (0.5) .* t)) .^ m .* (exp.((-0.5) .* κ .* t) .* (cosh.((0.5) .* (κ .^ (2.0)+(-4) .* ω .^ (2.0)) .^ (0.5) .* t)+(1im*(-2)) .* ω .* (κ .^ (2.0)+(-4) .* ω .^ (2.0)) .^ (-0.5) .* sinh.((0.5) .* (κ .^ (2.0)+(-4) .* ω .^ (2.0)) .^ (0.5) .* t))) .^ ((-1) .* m+N)+(-1) .* (m+(-1) .* N) .* ω .* (κ .^ (2.0)+(-4) .* ω .^ (2.0)) .^ (0.5) .* ((-2)+(κ .^ (2.0)+(-4) .* ω .^ (2.0)) .^ (0.5) .* t .* coth.((0.5) .* (κ .^ (2.0)+(-4) .* ω .^ (2.0)) .^ (0.5) .* t)) .* (exp.((-0.5) .* κ .* t) .* κ .* (κ .^ (2.0)+(-4) .* ω .^ (2.0)) .^ (-0.5) .* sinh.((0.5) .* (κ .^ (2.0)+(-4) .* ω .^ (2.0)) .^ (0.5) .* t)) .^ ((-1) .* m+N) .* (exp.((-0.5) .* κ .* t) .* (cosh.((0.5) .* (κ .^ (2.0)+(-4) .* ω .^ (2.0)) .^ (0.5) .* t)+(1im*2) .* ω .* (κ .^ (2.0)+(-4) .* ω .^ (2.0)) .^ (-0.5) .* sinh.((0.5) .* (κ .^ (2.0)+(-4) .* ω .^ (2.0)) .^ (0.5) .* t))) .^ m+1im .* exp.((-0.5) .* κ .* t) .* m .* (exp.((-0.5) .* κ .* t) .* κ .* (κ .^ (2.0)+(-4) .* ω .^ (2.0)) .^ (-0.5) .* sinh.((0.5) .* (κ .^ (2.0)+(-4) .* ω .^ (2.0)) .^ (0.5) .* t)) .^ ((-1) .* m+N) .* (exp.((-0.5) .* κ .* t) .* (cosh.((0.5) .* (κ .^ (2.0)+(-4) .* ω .^ (2.0)) .^ (0.5) .* t)+(1im*2) .* ω .* (κ .^ (2.0)+(-4) .* ω .^ (2.0)) .^ (-0.5) .* sinh.((0.5) .* (κ .^ (2.0)+(-4) .* ω .^ (2.0)) .^ (0.5) .* t))) .^ ((-1)+m) .* (2 .* ω .^ (2.0) .* (κ .^ (2.0)+(-4) .* ω .^ (2.0)) .^ (0.5) .* t .* cosh.((0.5) .* (κ .^ (2.0)+(-4) .* ω .^ (2.0)) .^ (0.5) .* t)+((1im*4) .* ω .^ 3 .* t+κ .^ (2.0) .* ((-1)+(1im*(-1)) .* ω .* t)) .* sinh.((0.5) .* (κ .^ (2.0)+(-4) .* ω .^ (2.0)) .^ (0.5) .* t))+1im .* exp.((-0.5) .* κ .* t) .* (m+(-1) .* N) .* (exp.((-0.5) .* κ .* t) .* κ .* (κ .^ (2.0)+(-4) .* ω .^ (2.0)) .^ (-0.5) .* sinh.((0.5) .* (κ .^ (2.0)+(-4) .* ω .^ (2.0)) .^ (0.5) .* t)) .^ m .* (exp.((-0.5) .* κ .* t) .* (cosh.((0.5) .* (κ .^ (2.0)+(-4) .* ω .^ (2.0)) .^ (0.5) .* t)+(1im*(-2)) .* ω .* (κ .^ (2.0)+(-4) .* ω .^ (2.0)) .^ (-0.5) .* sinh.((0.5) .* (κ .^ (2.0)+(-4) .* ω .^ (2.0)) .^ (0.5) .* t))) .^ ((-1)+(-1) .* m+N) .* (2 .* ω .^ (2.0) .* (κ .^ (2.0)+(-4) .* ω .^ (2.0)) .^ (0.5) .* t .* cosh.((0.5) .* (κ .^ (2.0)+(-4) .* ω .^ (2.0)) .^ (0.5) .* t)+1im .* ((-4) .* ω .^ 3 .* t+κ .^ (2.0) .* (1im+ω .* t)) .* sinh.((0.5) .* (κ .^ (2.0)+(-4) .* ω .^ (2.0)) .^ (0.5) .* t)))

function QFIqubit(ρ11,ρ12,dρ12)
    reC=real(ρ12./ρ11)
    imC=imag(ρ12./ρ11)
    redC=real(dρ12./ρ11)
    imdC=imag(dρ12./ρ11)
    return 2*ρ11 .* (redC .^ 2 + imdC .^ 2 + ( (reC .* redC + imC .* imdC) .^ 2)./(1 - reC .^ 2 - imC .^ 2))
end
